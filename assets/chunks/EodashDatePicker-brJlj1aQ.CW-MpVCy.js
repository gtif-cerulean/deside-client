import{aH as R,aI as q,p as j,h as H,al as K,ak as G,q as J,v as L,c as $,G as k,aJ as U,w as g,k as f,aK as W,o as y,j as C,as as D,b as S,e as x,K as _,W as Q,B as X,aL as O,a0 as Z}from"./framework.c24lRxR4.js";import{u as ee,a as te,m as ae,d as B,l as M,V as A,b as E,c as I,e as F,_ as ne,f as T,g as Y,i as se}from"./eo-dash.BU7FIqgH.js";import{V as oe}from"./VTooltip-DKOCofTl.DXeUYh51.js";import"./theme.DvORrVRG.js";import"./commonjsHelpers.BosuxZz1.js";import"./VOverlay-CiQn3F6n.DU4-PA3H.js";import"./forwardRefs-C2UOEnvr.B2uHbjRU.js";import"./transition-w_2EtUxa.DiZqNzMB.js";function re(t,r){const u=typeof t=="string"?X(t):t,n=le(u,r);return{mounted:n,updated:n,unmounted(c){O(null,c)}}}function le(t,r){return function(u,n,c){var m,w,o;const d=typeof r=="function"?r(n):r,h=((m=n.value)==null?void 0:m.text)??n.value??(d==null?void 0:d.text),v=se(n.value)?n.value:{},l=()=>h??u.textContent,i=(c.ctx===n.instance.$?(w=ie(c,n.instance.$))==null?void 0:w.provides:(o=c.ctx)==null?void 0:o.provides)??n.instance.$.provides,b=Z(t,_(d,v),l);b.appContext=Object.assign(Object.create(null),n.instance.$.appContext,{provides:i}),O(b,u)}}function ie(t,r){const u=new Set,n=d=>{var h,v;for(const l of d){if(!l)continue;if(l===t||l.el&&t.el&&l.el===t.el)return!0;u.add(l);let i;if(l.suspense?i=n([l.ssContent]):Array.isArray(l.children)?i=n(l.children):(h=l.component)!=null&&h.vnode&&(i=n([(v=l.component)==null?void 0:v.subTree])),i)return i;u.delete(l)}return!1};if(!n([r.subTree]))return r;const c=Array.from(u).reverse();for(const d of c)if(d.component)return d.component;return r}const V=re(oe,t=>{var r;return{activator:"parent",location:(r=t.arg)==null?void 0:r.replace("-"," "),text:typeof t.value=="boolean"?void 0:t.value}}),ce={ref:"rootRef",class:"datePicker"},de={class:"bg-surface d-flex flex-row align-center justify-center pb-1",style:{overflow:"hidden",width:"100%"}},ue={class:"flex rounded-lg border border-gray-300 dark:border-gray-600",style:{margin:"2px","min-width":"0"}},fe=["value"],me={class:"d-flex flex-row align-center justify-center pb-1",style:{overflow:"hidden",width:"100%"}},pe={class:"flex rounded-lg border border-gray-300 dark:border-gray-600",style:{margin:"2px","min-width":"0"}},ye=["value"],De={__name:"EodashDatePicker",props:{hintText:{type:String,default:null},hideArrows:{type:Boolean,default:!1},hideInputField:{type:Boolean,default:!1},toggleCalendar:{type:Boolean,default:!1}},setup(t){W(o=>({"45a34dce":w.value}));const{lgAndDown:r}=ee(),u=R("rootRef"),n=R("datePicker"),c=q((o,e)=>({get(){return o(),new Date(B.value).getTime()},set(s){var p;e(),M.debug("Datepicker setting currentDate",B.value);const a=new Date(s);B.value=a.toISOString(),(p=n.value)==null||p.move({month:a.getMonth()+1,year:a.getFullYear()})}})),d=j({input:"YYYY-MM-DD"}),h=o=>{const e=o.getFullYear(),s=o.getMonth()+1,a=o.getDate();return`${e}-${s<10?"0"+s:s}-${a<10?"0"+a:a}`},v=o=>{var e;c.value=new Date((e=o.target)==null?void 0:e.value).getTime()},l=H(()=>h(new Date(c.value))),i=K([]),b=G(te(),"selectedStac");J(b,async(o,e)=>{var s;if(o&&(e==null?void 0:e.id)!==o.id){M.debug("Datepicker selected STAC change triggered"),i.splice(0,i.length);for(let a=0;a<T.length;a++){M.debug("Retrieving dates",T[a]),await T[a].fetchCollection();const p=[...new Set((s=T[a].getItems())==null?void 0:s.reduce((P,N)=>{const z=Date.parse(N.datetime);return z&&P.push(new Date(z)),P},[]))];i.push({key:"id-"+a.toString()+Math.random().toString(16).slice(2),dot:{style:{backgroundColor:Y[a%Y.length]}},dates:p,content:{style:{color:"#000000","font-weight":"bold"}}})}}},{immediate:!0});function m(o){if(i.length){let e=o?1/0:-1/0;i.forEach(s=>{s!=null&&s.dates&&s.dates.forEach(a=>{a instanceof Date&&(e=Math[o?"min":"max"](e,a.getTime()))})}),c.value=e===-1/0?Date.now():e===1/0?0:e}}const w=j("");return L(()=>{w.value=document.querySelector("eo-dash")?"translate3d(50px,-80px,0)":"translate3d(0px,-80px,0)"}),ae(u),(o,e)=>(y(),$("div",ce,[k(f(ne),{ref:"datePicker",modelValue:c.value,"onUpdate:modelValue":e[4]||(e[4]=s=>c.value=s),modelModifiers:{number:!0},attributes:i,masks:d.value,expanded:"",class:"bg-surface overflow-auto",style:{"background-color":"transparent","max-width":"100%"}},U({_:2},[t.toggleCalendar?{name:"default",fn:g(({inputValue:s,inputEvents:a})=>[C("div",de,[t.hideArrows?x("v-if",!0):D((y(),S(I,{key:0,density:"compact",size:f(r)?"x-small":"large",variant:"text",onClick:e[0]||(e[0]=p=>m(!0)),class:"py-2",style:{"flex-shrink":"1"}},{default:g(()=>[k(A,{icon:[f(E)]},null,8,["icon"])]),_:1},8,["size"])),[[V,"Set date to oldest available dataset","bottom"]]),C("div",ue,[t.hideInputField?x("v-if",!0):(y(),$("input",_({key:0,value:s},Q(a,!0),{class:"flex-grow px-1 py-1 dark:bg-gray-700",style:{margin:"1px",width:"100%","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}}),null,16,fe))]),t.hideArrows?x("v-if",!0):D((y(),S(I,{key:1,density:"compact",size:f(r)?"x-small":"large",variant:"text",onClick:e[1]||(e[1]=p=>m(!1)),class:"py-2",style:{"flex-shrink":"1"}},{default:g(()=>[k(A,{icon:[f(F)]},null,8,["icon"])]),_:1},8,["size"])),[[V,"Set date to latest available dataset","bottom"]])])]),key:"0"}:{name:"footer",fn:g(()=>[C("div",me,[t.hideArrows?x("v-if",!0):D((y(),S(I,{key:0,density:"compact",size:f(r)?"x-small":"large",variant:"text",onClick:e[2]||(e[2]=s=>m(!0)),class:"py-2",style:{"flex-shrink":"1"}},{default:g(()=>[k(A,{icon:[f(E)]},null,8,["icon"])]),_:1},8,["size"])),[[V,"Set date to oldest available dataset","bottom"]]),C("div",pe,[t.hideInputField?x("v-if",!0):(y(),$("input",{key:0,value:l.value,onChange:v,class:"flex-grow px-1 py-1 dark:bg-gray-700",style:{margin:"1px",width:"100%","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},null,40,ye))]),t.hideArrows?x("v-if",!0):D((y(),S(I,{key:1,density:"compact",size:f(r)?"x-small":"large",variant:"text",onClick:e[3]||(e[3]=s=>m(!1)),class:"py-2",style:{"flex-shrink":"1"}},{default:g(()=>[k(A,{icon:[f(F)]},null,8,["icon"])]),_:1},8,["size"])),[[V,"Set date to latest available dataset","bottom"]])])]),key:"1"}]),1032,["modelValue","attributes","masks"])],512))}};export{De as default};
