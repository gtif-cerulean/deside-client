import{aH as R,p as b,al as $,ak as j,q as M,c as C,G as h,w as v,k as g,o as p,j as S,as as A,b as V,e as k,B as P,aI as E,a0 as F,K as O}from"./framework.DvYN4D0M.js";import{u as Y,m as N,d as x,l as w,V as B,a as q,b as I,c as G,_ as H,e as y,i as K}from"./eo-dash.D5X-Ch81.js";import{V as L}from"./VTooltip-CDu3bErh.Bne9d0zF.js";import"./theme.BR9QJcCc.js";import"./commonjsHelpers.BosuxZz1.js";import"./VOverlay-D89omJis.Cy7axrG_.js";import"./forwardRefs-CYrR6bMw.C6LiLlDM.js";import"./transition-DG9nRSW4.BYb-RGVA.js";function U(n,o){const l=typeof n=="string"?P(n):n,t=z(l,o);return{mounted:t,updated:t,unmounted(c){E(null,c)}}}function z(n,o){return function(l,t,c){var i,m,f;const s=typeof o=="function"?o(t):o,d=((i=t.value)==null?void 0:i.text)??t.value??(s==null?void 0:s.text),r=K(t.value)?t.value:{},e=()=>d??l.textContent,a=(c.ctx===t.instance.$?(m=J(c,t.instance.$))==null?void 0:m.provides:(f=c.ctx)==null?void 0:f.provides)??t.instance.$.provides,u=F(n,O(s,r),e);u.appContext=Object.assign(Object.create(null),t.instance.$.appContext,{provides:a}),E(u,l)}}function J(n,o){const l=new Set,t=s=>{var d,r;for(const e of s){if(!e)continue;if(e===n||e.el&&n.el&&e.el===n.el)return!0;l.add(e);let a;if(e.suspense?a=t([e.ssContent]):Array.isArray(e.children)?a=t(e.children):(d=e.component)!=null&&d.vnode&&(a=t([(r=e.component)==null?void 0:r.subTree])),a)return a;l.delete(e)}return!1};if(!t([o.subTree]))return o;const c=Array.from(l).reverse();for(const s of c)if(s.component)return s.component;return o}const T=U(L,n=>{var o;return{activator:"parent",location:(o=n.arg)==null?void 0:o.replace("-"," "),text:typeof n.value=="boolean"?void 0:n.value}}),Q={class:"d-flex flex-row align-center justify-center pb-1"},W={class:"flex rounded-lg border border-gray-300 dark:border-gray-600",style:{margin:"2px"}},X=["value"],ie={__name:"EodashDatePicker",props:{hintText:{type:String,default:null},hideArrows:{type:Boolean,default:!1},hideInputField:{type:Boolean,default:!1}},setup(n){const o=R((r,e)=>({get(){return r(),new Date(x.value).getTime()},set(a){e(),w.debug("Datepicker setting currentDate",x.value),x.value=new Date(a).toISOString()}})),l=b({input:"YYYY-MM-DD"}),t=$([]),c=b(null),s=j(Y(),"selectedStac");M(s,async(r,e)=>{var a;if(r&&(e==null?void 0:e.id)!==r.id){w.debug("Datepicker selected STAC change triggered");const u=["#009E73","#0072B2","#E69F00","#CC79A7","#56B4E9","#D55E00"];t.splice(0,t.length);for(let i=0;i<y.length;i++){w.debug("Retrieving dates",y[i]),await y[i].fetchCollection();const m=[...new Set((a=y[i].getItems())==null?void 0:a.reduce((f,_)=>{const D=Date.parse(_.datetime);return D&&f.push(new Date(D)),f},[]))];t.push({key:"id-"+i.toString()+Math.random().toString(16).slice(2),bar:{style:{backgroundColor:u[i%u.length]}},dates:m,content:{style:{color:"#000000","font-weight":"bold"}}})}}},{immediate:!0});function d(r){if(t.length){let e=r?1/0:-1/0;t.forEach(a=>{a!=null&&a.dates&&a.dates.forEach(u=>{u instanceof Date&&(e=Math[r?"min":"max"](e,u.getTime()))})}),o.value=e===-1/0?Date.now():e===1/0?0:e}}return N(c),(r,e)=>(p(),C("div",{ref_key:"rootRef",ref:c,class:"datePicker"},[h(g(H),{modelValue:o.value,"onUpdate:modelValue":e[2]||(e[2]=a=>o.value=a),modelModifiers:{number:!0},attributes:t,masks:l.value,expanded:"",class:"bg-surface overflow-auto",style:{"background-color":"transparent","max-width":"100%"}},{footer:v(()=>[S("div",Q,[n.hideArrows?k("v-if",!0):A((p(),V(I,{key:0,density:"compact",variant:"text",onClick:e[0]||(e[0]=a=>d(!0))},{default:v(()=>[h(B,{icon:[g(q)]},null,8,["icon"])]),_:1})),[[T,"Set date to oldest available dataset","bottom"]]),S("div",W,[n.hideInputField?k("v-if",!0):(p(),C("input",{key:0,value:new Date(o.value).toLocaleDateString(),style:{margin:"1px"},class:"flex-grow px-1 py-1 dark:bg-gray-700"},null,8,X))]),n.hideArrows?k("v-if",!0):A((p(),V(I,{key:1,density:"compact",variant:"text",onClick:e[1]||(e[1]=a=>d(!1))},{default:v(()=>[h(B,{icon:[g(G)]},null,8,["icon"])]),_:1})),[[T,"Set date to latest available dataset","bottom"]])])]),_:1},8,["modelValue","attributes","masks"])],512))}};export{ie as default};
