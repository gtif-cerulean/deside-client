import{aK as q,aL as T,aM as K,p as M,h as G,ag as H,q as L,v as O,c as k,o as l,G as f,aN as U,w as d,j as g,as as y,e as u,b as h,k as o,K as X,X as J}from"./framework.74XsaJss.js";import{u as Q,l as P,d as b,s as W,a as Z,b as ee,V as v,c as w,m as V,e as z,_ as te,g as ae,f as se,h as oe}from"./eo-dash.CGZK6l7i.js";import{T as x}from"./index-10iHeNjW.BINmlBKH.js";import"./item.koN_VtZd.js";import"./commonjsHelpers.BosuxZz1.js";import"./VTooltip-BGN2-cvE.BjV-sdCi.js";import"./VOverlay-ScJnt2dG.B4jhtuUd.js";import"./forwardRefs-8K3hNLhI.DZQQ4ScR.js";import"./transition-DIeloNSD.ByEeVP-n.js";const re={ref:"rootRef",class:"datePicker"},ne={class:"d-flex flex-row align-center justify-center pb-1",style:{overflow:"hidden",width:"100%"}},le={class:"flex rounded-lg border border-gray-300 dark:border-gray-600",style:{margin:"2px","min-width":"0"}},ie=["value"],de={class:"d-flex flex-row align-center justify-center pb-1",style:{overflow:"hidden",width:"100%"}},ue={class:"flex rounded-lg border border-gray-300 dark:border-gray-600",style:{margin:"2px","min-width":"0"}},ce=["value"],ke={__name:"EodashDatePicker",props:{hintText:{type:String,default:null},hideArrows:{type:Boolean,default:!1},hideInputField:{type:Boolean,default:!1},toggleCalendar:{type:Boolean,default:!1}},setup(r){q(a=>({"254ea936":S.value}));const{lgAndDown:m}=Q(),B=T("rootRef"),$=T("datePicker"),c=K((a,e)=>({get(){return a(),new Date(b.value).getTime()},set(t){var n;e(),P.debug("Datepicker setting currentDate",b.value);const s=new Date(t);b.value=s.toISOString(),(n=$.value)==null||n.move({month:s.getMonth()+1,year:s.getFullYear()})}})),E=M({input:"YYYY-MM-DD"}),F=a=>{const e=a.getFullYear(),t=a.getMonth()+1,s=a.getDate();return`${e}-${t<10?"0"+t:t}-${s<10?"0"+s:s}`},R=a=>{var e;c.value=new Date((e=a.target)==null?void 0:e.value).getTime()},_=G(()=>F(new Date(c.value))),i=H([]),{selectedCompareStac:Y,selectedStac:N}=W(Z());L([N,Y],async([a,e])=>{if(i.splice(0,i.length),!a&&!e){P.debug("No STAC selected, clearing datepicker attributes");return}const t=[...await D(se),...await D(oe)];i.push(...t)},{immediate:!0});async function D(a){return!a||!a.length?[]:await Promise.all(a.map((e,t)=>e.fetchCollection().then(()=>{var C;const s=ae(e.getItems());if(!s)return[];const n=[...new Set((C=e.getItems())==null?void 0:C.reduce((I,j)=>{const A=Date.parse(j[s]);return A&&I.push(new Date(A)),I},[]))];return{key:"id-"+t.toString()+Math.random().toString(16).slice(2),dot:{style:{backgroundColor:e.color}},dates:n,content:{style:{color:"#000000","font-weight":"bold"}}}})))}function p(a){if(i.length){let e=a?1/0:-1/0;i.forEach(t=>{t!=null&&t.dates&&t.dates.forEach(s=>{s instanceof Date&&(e=Math[a?"min":"max"](e,s.getTime()))})}),c.value=e===-1/0?Date.now():e===1/0?0:e}}const S=M("");return O(()=>{S.value=document.querySelector("eo-dash")?"translate3d(50px,-80px,0)":"translate3d(0px,-80px,0)"}),ee(B),(a,e)=>(l(),k("div",re,[f(o(te),{ref:"datePicker",modelValue:c.value,"onUpdate:modelValue":e[4]||(e[4]=t=>c.value=t),modelModifiers:{number:!0},attributes:i,masks:E.value,expanded:"",class:"overflow-auto",style:{"background-color":"transparent","max-width":"100%"}},U({_:2},[r.toggleCalendar?{name:"default",fn:d(({inputValue:t,inputEvents:s})=>[g("div",ne,[r.hideArrows?u("v-if",!0):y((l(),h(v,{key:0,density:"compact",size:o(m)?"x-small":"large",variant:"text",onClick:e[0]||(e[0]=n=>p(!0)),class:"py-2",style:{"flex-shrink":"1",padding:"0"}},{default:d(()=>[f(w,{icon:[o(V)]},null,8,["icon"])]),_:1},8,["size"])),[[x,"Set date to oldest available dataset","bottom"]]),g("div",le,[r.hideInputField?u("v-if",!0):(l(),k("input",X({key:0,value:t},J(s,!0),{class:"flex-grow px-1 py-1 dark:bg-gray-700",style:{margin:"1px",width:"100%","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}}),null,16,ie))]),r.hideArrows?u("v-if",!0):y((l(),h(v,{key:1,density:"compact",size:o(m)?"x-small":"large",variant:"text",onClick:e[1]||(e[1]=n=>p(!1)),class:"py-2",style:{"flex-shrink":"1",padding:"0"}},{default:d(()=>[f(w,{icon:[o(z)]},null,8,["icon"])]),_:1},8,["size"])),[[x,"Set date to latest available dataset","bottom"]])])]),key:"0"}:{name:"footer",fn:d(()=>[g("div",de,[r.hideArrows?u("v-if",!0):y((l(),h(v,{key:0,density:"compact",size:o(m)?"x-small":"large",variant:"text",onClick:e[2]||(e[2]=t=>p(!0)),class:"py-2",style:{"flex-shrink":"1"}},{default:d(()=>[f(w,{icon:[o(V)]},null,8,["icon"])]),_:1},8,["size"])),[[x,"Set date to oldest available dataset","bottom"]]),g("div",ue,[r.hideInputField?u("v-if",!0):(l(),k("input",{key:0,value:_.value,onChange:R,class:"flex-grow px-1 py-1 dark:bg-gray-700",style:{margin:"1px",width:"100%","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},null,40,ce))]),r.hideArrows?u("v-if",!0):y((l(),h(v,{key:1,density:"compact",size:o(m)?"x-small":"large",variant:"text",onClick:e[3]||(e[3]=t=>p(!1)),class:"py-2",style:{"flex-shrink":"1"}},{default:d(()=>[f(w,{icon:[o(z)]},null,8,["icon"])]),_:1},8,["size"])),[[x,"Set date to latest available dataset","bottom"]])])]),key:"1"}]),1032,["modelValue","attributes","masks"])],512))}};export{ke as default};
